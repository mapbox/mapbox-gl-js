<!doctype html>
<head>
    <!-- https://docs.mapbox.com/mapbox-gl-js/guides/browsers-and-testing/#csp-directives -->
    <title>CSP rules</title>
</head>
<body>
    <div id="map"></div>
    <script src="/dist/mapbox-gl.js"></script>
    <script type="module">
        import {getAccessToken} from '../debug/access_token_generated.js';
        mapboxgl.accessToken = getAccessToken();

        window.addEventListener('message', (e) => {
            if (e.data.type === 'load') {
                const map = new mapboxgl.Map({
                    container: 'map',
                    style: e.data.payload,
                    center: [-74.006, 40.7128], // NYC
                    zoom: 16,
                    pitch: 60
                });

                map.once('load', () => {
                    window.parent.postMessage({type: "map.load"});
                });
            }
        });
    </script>
</body>
