---
layout: example
category: example
title: Navigate the map with game-like controls
description: Move around the map with game-like controls.
tags:
  - camera
---

<style>
    /* Dark attribution */
    .mapboxgl-ctrl.mapboxgl-ctrl-attrib { background-color:rgba(0,0,0,0.5); }
    .mapboxgl-ctrl.mapboxgl-ctrl-attrib a { color:#fff; }  

    #instructions {
        background-color: rgba(255, 255, 255, 0.1);
        color: #fff;
        padding: 10px;
        border-radius: 3px;
        position: absolute;
        top: 50px;
        width: 80%;
        margin: 0 10%;
        font-family: 'Open sans', sans-serif;
        text-align: center;
    }

</style>

<div id='map'></div>
<div id='instructions'>Click on the map, then use the arrow keys to navigate the map.</div>


<script>
    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/dark-v9',
        center: [-87.6298, 41.8781],
        zoom: 17,
        bearing: -12,
        pitch: 60,
        interactive: false
    });

    // pixels the map pans each second a key is pressed
    var DELTA_DISTANCE = 2000;
    // degrees the map rotates each second a key is pressed
    var DELTA_DEGREES = 250;

    var instructions = document.getElementById('instructions');
    map.on('click', function() {
        instructions.style.display = 'none';
    });

    function easeFunction(t) {
        return t * (2 - t);
    }

    var keysDown = {};
    var lastUpdate = undefined;

    function update() {
        var now = new Date().getTime();
        var dt = (now - (lastUpdate || now)) / 1000;

        var deltaDistance = DELTA_DISTANCE * dt;
        var deltaDegrees = DELTA_DEGREES * dt;

        var newBearing = map.getBearing();
        var offsetY = 0;

        if (keysDown[38] || keysDown[87]) { // up or W
            offsetY += deltaDistance;
        }
        if (keysDown[40] || keysDown[83]) { // down or S
            offsetY -= deltaDistance;
        }
        if (keysDown[37] || keysDown[65]) { // left or A
            newBearing -= deltaDegrees
        }
        if (keysDown[39] || keysDown[68]) { // right or D
            newBearing += deltaDegrees;
        }

        map.easeTo({
            bearing: newBearing,
            center: map.getCenter(),
            offset: [0, offsetY],
            easing: easeFunction,
        });

        lastUpdate = now;
        requestAnimationFrame(update);
    }

    map.on('load', function() {
        map.getCanvas().addEventListener('keydown', function(e) {
            e.preventDefault();
            keysDown[e.which] = true;
        }, true);

        map.getCanvas().addEventListener('keyup', function(e) {
            e.preventDefault();
            if (keysDown[e.which]) {
              delete keysDown[e.which];
            }
        }, true);

        map.getCanvas().addEventListener('blur', function(e) {
            keysDown = {};
        });

        requestAnimationFrame(update);
    });
</script>
